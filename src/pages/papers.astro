---
import Layout from "@/layouts/Layout.astro";
import { publications } from "@/data/cv";
import { highlightAuthor } from "@/lib/utils";
import { template } from "@/settings";

const ALL_PAPERS = publications;

// 第 1 頁：顯示前 4 篇
const perPage = 4;
const pageItems = ALL_PAPERS.slice(0, perPage);

const currentPage = 1;
const totalPages = Math.ceil(ALL_PAPERS.length / perPage);

// /Soil_Academia/papers 之類
const basePath = `${template.base}/papers`;
const page1Url = `${basePath}/`;
const page2Url = `${basePath}/2/`;

---

<Layout title="Papers">
  <div class="prose max-w-none">
    <h1 class="text-3xl font-bold mb-8">Publications</h1>

    <div class="space-y-8">
      {
        pageItems.map((paper) => (
          <div class="card bg-base-200">
            <div class="card-body">
              <h2 class="card-title text-xl">
                <a href={paper.link} class="hover:text-accent" target="_blank">
                  {paper.title}
                </a>
              </h2>
              <p class="text-base mb-2">
                <span class="font-medium">Authors:</span>{" "}
                <span set:html={highlightAuthor(paper.authors)} />
              </p>
              <p class="text-sm mb-3">
                <span class="italic">{paper.journal}</span> • {paper.time}
              </p>
              <p class="text-sm text-base-content/80" style="text-align: justify;">
                {paper.abstract || "No abstract available."}
              </p>
              <div class="card-actions justify-end mt-4">
                <a
                  href={paper.link}
                  class="btn btn-sm btn-secondary text-secondary-content"
                  target="_blank"
                >
                  Read Paper
                </a>
              </div>
            </div>
          </div>
        ))
      }
    </div>

 <div class="flex justify-center mt-8">
  <div class="join">
    {/* 第一頁沒有上一頁 */}
    <button class="join-item btn btn-sm" disabled>«</button>

    {/* 目前在第 1 頁，就不要連結 */}
    <button class="join-item btn btn-sm btn-active">1</button>

    {/* 往第 2 頁：用絕對路徑（含 base） */}
    <a href={page2Url} class="join-item btn btn-sm">
      2
    </a>

    <a href={page2Url} class="join-item btn btn-sm">
      »
    </a>
  </div>
</div>

  </div>
</Layout>
